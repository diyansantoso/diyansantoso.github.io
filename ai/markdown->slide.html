<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Markdown → Slides</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0b1220;
      --panel: #0f172a;
      --muted: #94a3b8;
      --text: #e5e7eb;
      --accent: #3b82f6;
      --accent-2: #22d3ee;
      --border: rgba(148,163,184,0.18);
      --slide-bg: #0c1529;
      --shadow: 0 10px 30px rgba(2,6,23,0.5);
    }
    [data-theme="light"] {
      --bg: #f7fafc;
      --panel: #ffffff;
      --muted: #4b5563;
      --text: #0f172a;
      --accent: #2563eb;
      --accent-2: #0ea5e9;
      --border: rgba(2,6,23,0.08);
      --slide-bg: #ffffff;
      --shadow: 0 10px 24px rgba(2,6,23,0.08);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: radial-gradient(1200px 800px at 10% -10%, rgba(59,130,246,0.08), transparent 40%),
                  radial-gradient(900px 700px at 110% 10%, rgba(34,211,238,0.08), transparent 40%),
                  var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.5;
    }

    header {
      position: sticky; top: 0; z-index: 50;
      backdrop-filter: saturate(1.2) blur(10px);
      background: linear-gradient(to bottom, rgba(15,23,42,0.65), rgba(15,23,42,0.35));
      border-bottom: 1px solid var(--border);
    }
    .bar {
      max-width: 1200px; margin: 0 auto; padding: 14px 20px;
      display: flex; align-items: center; gap: 14px; justify-content: space-between;
    }
    .brand {
      display: flex; align-items: center; gap: 10px; font-weight: 700; letter-spacing: 0.2px;
    }
    .logo {
      width: 28px; height: 28px; border-radius: 8px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.15), 0 6px 18px rgba(37,99,235,0.35);
    }
    .title { font-size: 18px; }
    .subtitle { font-size: 12px; color: var(--muted); letter-spacing: 0.3px; }

    .toolbar { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .btn {
      appearance: none; border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      color: var(--text); padding: 10px 12px; border-radius: 10px;
      font-weight: 600; font-size: 13px; letter-spacing: 0.2px;
      display: inline-flex; align-items: center; gap: 8px; cursor: pointer;
      transition: transform .04s ease, border-color .2s ease, background .2s ease;
    }
    .btn:hover { border-color: rgba(59,130,246,0.5); }
    .btn:active { transform: translateY(1px); }
    .btn.primary {
      background: linear-gradient(135deg, rgba(59,130,246,0.25), rgba(34,211,238,0.15));
      border-color: rgba(59,130,246,0.6);
    }
    .kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px; padding: 2px 6px; border-radius: 6px; border: 1px solid var(--border);
      color: var(--muted); background: rgba(255,255,255,0.03);
    }

    .container {
      max-width: 1200px; margin: 20px auto; padding: 0 20px;
      display: grid; grid-template-columns: 1fr 1fr; gap: 18px;
    }
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid var(--border); border-radius: 16px; overflow: hidden; box-shadow: var(--shadow);
    }
    .panel-header {
      padding: 12px 14px; display: flex; align-items: center; justify-content: space-between;
      border-bottom: 1px solid var(--border); background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0));
    }
    .panel-header h3 { margin: 0; font-size: 13px; color: var(--muted); font-weight: 700; letter-spacing: .4px; text-transform: uppercase; }
    .panel-body { padding: 0; }

    textarea {
      width: 100%; height: 65vh; resize: vertical;
      padding: 16px 18px; border: none; outline: none; background: transparent; color: var(--text);
      font: 14px/1.6 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      caret-color: var(--accent);
    }
    .preview {
      height: 65vh; overflow: auto; background: var(--panel);
      padding: 0; display: flex; align-items: stretch; justify-content: center;
    }

    /* Slide Deck */
    .deck {
      width: 100%; display: flex; align-items: center; justify-content: center; position: relative;
      background: radial-gradient(800px 400px at 50% -10%, rgba(59,130,246,0.18), transparent 40%), var(--panel);
    }
    .slide {
      width: min(92%, 980px); aspect-ratio: 16 / 9; background: var(--slide-bg);
      border-radius: 18px; border: 1px solid var(--border); box-shadow: var(--shadow);
      padding: 48px 54px; color: var(--text); display: none; position: relative; overflow: hidden;
    }
    .slide.active { display: block; }
    .slide h1, .slide h2, .slide h3, .slide h4 { margin: 0 0 16px 0; line-height: 1.2; }
    .slide h1 { font-size: clamp(28px, 3.2vw, 48px); }
    .slide h2 { font-size: clamp(22px, 2.4vw, 34px); }
    .slide h3 { font-size: clamp(20px, 2vw, 28px); }
    .slide p, .slide li { font-size: clamp(16px, 1.5vw, 20px); color: var(--text); }
    .slide ul, .slide ol { padding-left: 1.2em; margin: 0.5em 0; }
    .slide pre {
      background: rgba(2,6,23,0.55); border: 1px solid var(--border); padding: 12px 14px; border-radius: 10px; overflow: auto;
      font-size: clamp(12px, 1.2vw, 14px);
    }
    .slide code {
      background: rgba(2,6,23,0.4); border: 1px solid var(--border);
      padding: 2px 6px; border-radius: 6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas;
      font-size: 0.95em;
    }
    .slide .footer {
      position: absolute; bottom: 14px; right: 18px; color: var(--muted); font-size: 12px;
    }

    /* Pager */
    .pager {
      position: absolute; bottom: 14px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 6px; padding: 6px 8px; background: rgba(2,6,23,0.35);
      border: 1px solid var(--border); border-radius: 999px;
    }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(148,163,184,0.35); }
    .dot.active { background: linear-gradient(135deg, var(--accent), var(--accent-2)); }

    .hint {
      color: var(--muted); font-size: 12px;
    }

    @media (max-width: 980px) {
      .container { grid-template-columns: 1fr; }
      textarea, .preview { height: 60vh; }
    }
  </style>
</head>
<body data-theme="dark">
  <header>
    <div class="bar">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <div class="title">Markdown → Slides</div>
          <div class="subtitle">Convert markdown (--- as slide breaks) to a business-ready deck</div>
        </div>
      </div>
      <div class="toolbar">
        <button id="btnTheme" class="btn" title="Toggle Theme (T)">
          <span>Theme</span><span class="kbd">T</span>
        </button>
        <button id="btnSample" class="btn" title="Load Sample Deck">
          Load Sample
        </button>
        <button id="btnFullscreen" class="btn" title="Full Screen (F)">
          Full Screen <span class="kbd">F</span>
        </button>
        <span class="hint">Nav: ← → or Space</span>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="panel">
      <div class="panel-header">
        <h3>Markdown Input</h3>
        <div class="hint">Use --- on its own line to break slides</div>
      </div>
      <div class="panel-body">
        <textarea id="mdInput" spellcheck="false"></textarea>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h3>Live Preview</h3>
        <div class="hint">Renders instantly as you type</div>
      </div>
      <div class="panel-body preview">
        <div id="deck" class="deck" tabindex="0" aria-label="Slides Preview"></div>
      </div>
    </section>
  </main>

  <script>
    // Minimal markdown parser for business slides
    // Supports: #, ##, ###, lists, bold/italic, inline code, code fences, hr, paragraphs
    const md = {
      escapeHtml: (str) => str
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;"),
      inline: (str) => {
        // code
        str = str.replace(/`([^`]+)`/g, (_, c) => `<code>${md.escapeHtml(c)}</code>`);
        // bold
        str = str.replace(/\*\*([^*]+)\*\*/g, "<strong>$1</strong>");
        // italics
        str = str.replace(/\*([^*]+)\*/g, "<em>$1</em>");
        // simple link [text](url)
        str = str.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
        return str;
      },
      block: (text) => {
        // Fence code blocks ```
        const lines = text.split(/\r?\n/);
        let out = [];
        let inCode = false, codeLang = "", codeBuffer = [];
        for (let i = 0; i < lines.length; i++) {
          const line = lines[i];
          const fence = line.match(/^\s*```(\w+)?\s*$/);
          if (fence) {
            if (!inCode) {
              inCode = true; codeLang = fence[1] || ""; codeBuffer = [];
            } else {
              const code = md.escapeHtml(codeBuffer.join("\n"));
              out.push(`<pre><code class="language-${codeLang}">${code}</code></pre>`);
              inCode = false; codeLang = ""; codeBuffer = [];
            }
            continue;
          }
          if (inCode) { codeBuffer.push(line); continue; }

          // Headings
          if (/^\s*#{1}\s+/.test(line)) { out.push(`<h1>${md.inline(line.replace(/^\s*#\s+/, ""))}</h1>`); continue; }
          if (/^\s*#{2}\s+/.test(line)) { out.push(`<h2>${md.inline(line.replace(/^\s*##\s+/, ""))}</h2>`); continue; }
          if (/^\s*#{3}\s+/.test(line)) { out.push(`<h3>${md.inline(line.replace(/^\s*###\s+/, ""))}</h3>`); continue; }

          // Lists
          if (/^\s*[-*+]\s+/.test(line)) {
            // collect contiguous list
            const items = [];
            let j = i;
            while (j < lines.length && /^\s*[-*+]\s+/.test(lines[j])) {
              items.push(lines[j].replace(/^\s*[-*+]\s+/, ""));
              j++;
            }
            const lis = items.map(t => `<li>${md.inline(t)}</li>`).join("");
            out.push(`<ul>${lis}</ul>`);
            i = j - 1;
            continue;
          }

          // Horizontal rule
          if (/^\s*---\s*$/.test(line)) {
            // We treat --- at top parsing stage for slides, so here ignore as hr.
            out.push(`<hr style="opacity:.15;border:none;border-top:1px solid var(--border)"/>`);
            continue;
          }

          if (line.trim() === "") { out.push(""); continue; }

          // Paragraph
          out.push(`<p>${md.inline(line)}</p>`);
        }
        return out.join("\n");
      }
    };

    const deckEl = document.getElementById("deck");
    const inputEl = document.getElementById("mdInput");
    const btnTheme = document.getElementById("btnTheme");
    const btnSample = document.getElementById("btnSample");
    const btnFullscreen = document.getElementById("btnFullscreen");

    const SAMPLE = `# Executive Update: Q3 Results
Subtitle: Strategy, Metrics, and Next Steps

- Presenter: Jane Doe, VP Product
- Date: 2025-10-01

---

## Agenda
- Performance Overview
- Customer Growth & Churn
- Product Roadmap
- Risks & Mitigations
- Q&A

---

## Performance Overview
- Revenue: **$12.4M** (+18% QoQ)
- Gross Margin: 72% (↑ 2.3 pts)
- NRR: **122%**
- Top 3 drivers:
  - Enterprise upsell motion
  - Usage-based pricing
  - Onboarding automation

---

## Customer Metrics
- New logos: 142 (Target: 130)
- Churn: 2.4% (Goal: < 3%)
- CSAT: 4.6/5
- Expansion in FinServ and Healthcare

---

## Product Highlights
- Launched: SSO for SMB, Advanced Audit Trails
- Beta: AI-assisted workflows
- Roadmap (Next 2 Qtrs):
  - Real-time collaboration
  - Analytics workspace
  - SOC2 Type II

---

## Architecture Note
- Multi-tenant on Kubernetes
- Event-driven microservices
- Data plane: Kafka + ClickHouse
- Control plane: gRPC APIs

\`\`\`mermaid
graph TD
A[Client] --> B[Edge]
B --> C[API]
C --> D[Services]
D --> E[DBs]
\`\`\`

---

## Key Risks
- Talent market tightness
- Cloud cost variability
- Data residency requirements

Mitigations:
- Hiring pipeline partnerships
- Cost guardrails & FinOps
- Regional data sharding

---

## Call to Action
- Approve headcount +3 in Data Platform
- Align on FY roadmap by Nov 15
- Pilot 3 lighthouse customers

---

# Thank You
Questions?`;

    // Render markdown text into slides separated by lines containing only ---
    function renderSlides(text) {
      const rawSlides = text
        .replace(/\r\n/g, "\n")
        .split(/\n-{3}\n|^\s*---\s*$|^\s*---\s*$/gm)
        .map(s => s.trim())
        .filter(s => s.length > 0);

      const total = rawSlides.length || 1;
      deckEl.innerHTML = "";

      const pager = document.createElement("div");
      pager.className = "pager";

      rawSlides.forEach((slideText, idx) => {
        const slide = document.createElement("section");
        slide.className = "slide";
        slide.setAttribute("role", "group");
        slide.setAttribute("aria-roledescription", "slide");
        slide.setAttribute("aria-label", `Slide ${idx + 1} of ${total}`);
        slide.dataset.index = idx.toString();
        slide.innerHTML = md.block(slideText) + `<div class="footer">${idx + 1} / ${total}</div>`;
        deckEl.appendChild(slide);

        const dot = document.createElement("div");
        dot.className = "dot";
        dot.dataset.index = idx.toString();
        dot.addEventListener("click", () => goTo(idx));
        pager.appendChild(dot);
      });

      // Ensure at least one slide exists
      if (rawSlides.length === 0) {
        const empty = document.createElement("section");
        empty.className = "slide";
        empty.innerHTML = `<h2>Welcome</h2><p>Start typing markdown on the left. Use <code>---</code> on its own line to create a new slide.</p><div class="footer">1 / 1</div>`;
        deckEl.appendChild(empty);

        const dot = document.createElement("div");
        dot.className = "dot";
        pager.appendChild(dot);
      }

      deckEl.appendChild(pager);
      goTo(0);
    }

    // Navigation
    let currentIndex = 0;
    function goTo(i) {
      const slides = [...deckEl.querySelectorAll(".slide")];
      if (!slides.length) return;
      currentIndex = Math.max(0, Math.min(i, slides.length - 1));
      slides.forEach((s, idx) => s.classList.toggle("active", idx === currentIndex));
      const dots = [...deckEl.querySelectorAll(".dot")];
      dots.forEach((d, idx) => d.classList.toggle("active", idx === currentIndex));
      slides[currentIndex].scrollTop = 0;
    }
    function next() { goTo(currentIndex + 1); }
    function prev() { goTo(currentIndex - 1); }

    // Keyboard events
    document.addEventListener("keydown", (e) => {
      if (e.target === inputEl) return; // don't intercept typing
      if (e.key === "ArrowRight" || e.key === "PageDown" || e.key === " ") { e.preventDefault(); next(); }
      if (e.key === "ArrowLeft" || e.key === "PageUp") { e.preventDefault(); prev(); }
      if (e.key.toLowerCase() === "t") toggleTheme();
      if (e.key.toLowerCase() === "f") toggleFullScreen();
    });

    // Fullscreen
    function toggleFullScreen() {
      const el = deckEl;
      if (!document.fullscreenElement) {
        el.requestFullscreen?.();
      } else {
        document.exitFullscreen?.();
      }
    }

    // Theme
    function toggleTheme() {
      const root = document.body;
      const next = root.getAttribute("data-theme") === "dark" ? "light" : "dark";
      root.setAttribute("data-theme", next);
      localStorage.setItem("mdslides-theme", next);
    }
    btnTheme.addEventListener("click", toggleTheme);
    btnFullscreen.addEventListener("click", toggleFullScreen);

    // Sample loader
    btnSample.addEventListener("click", () => {
      inputEl.value = SAMPLE;
      renderSlides(inputEl.value);
      inputEl.focus();
    });

    // Live update (debounced)
    let t;
    inputEl.addEventListener("input", () => {
      clearTimeout(t);
      t = setTimeout(() => renderSlides(inputEl.value), 120);
    });

    // Click on deck to focus for key nav
    deckEl.addEventListener("click", () => deckEl.focus());

    // Initialize
    (function init() {
      const savedTheme = localStorage.getItem("mdslides-theme");
      if (savedTheme) document.body.setAttribute("data-theme", savedTheme);
      inputEl.value = SAMPLE;
      renderSlides(inputEl.value);
    })();
  </script>
</body>
</html>